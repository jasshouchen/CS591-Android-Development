Still need to combine with main body code
